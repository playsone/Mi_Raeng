<div class="container-fluid page-container d-flex flex-column vh-100 p-3 p-md-4">
  <header class="back-header">
    <button class="back-btn" type="button" (click)="goBack()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24" fill="currentColor">
        <path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path>
      </svg>
    </button>
  </header>

  <ng-container *ngIf="!isLoading && userProfile; else loadingTemplate">
    <header class="row justify-content-between align-items-center mb-3">
      <div class="col-auto">
        <div class="info-box">
          <img src="assets/images/time.png" alt="Time Icon" class="icon">
          <span>{{ userProfile.minute }}</span>
        </div>
      </div>
      <div class="col text-center profile-info">
        <img src="assets/images/profilefm.png" alt="Profile Picture" class="profile-pic">
        <span class="profile-name">{{ userProfile.name }}</span>
      </div>
      <div class="col-auto">
        <div class="info-box">
          <img src="assets/images/star.png" alt="Star Icon" class="icon">
          <span>{{ userProfile.score }}</span>
        </div>
      </div>
    </header>

     <main class="row flex-grow-1">
      <div class="col-12 text-center tree-container">
        
        <div class="watering-info">
          <p>คลิกเพื่อรดน้ำ</p>

          <ng-container *ngIf="userProfile.tree_progress < maxProgress">
            <button class="water-btn" (click)="waterTree(100)" [disabled]="userProfile.score < 100">
              <img src="assets/images/water.png" alt="Watering Can">
            </button>
          </ng-container>

          <ng-container *ngIf="userProfile.tree_progress >= maxProgress">
            <button class="water-btn collectable" (click)="waterTree(0)">
              <img src="assets/images/tree.png" alt="Collect Tree Icon">
              เก็บต้นไม้!
            </button>
          </ng-container>
        </div>
        <img [src]="'assets/images/' + treeImageName" alt="Tree" class="tree-logo">
      </div>
    </main>

    <footer class="row mt-auto">
      <div class="col-12 footer-container">
        <div class="progress-bar-wrapper">
          <div class="progress-bar-container">
            <div class="progress-bar-fill" [style.width.%]="progressPercentage"></div>
          </div>
          <span class="progress-text">{{ userProfile.tree_progress }}/{{ maxProgress }}</span>
        </div>
        <p class="accumulated-text">จำนวนต้นไม้สะสม {{ userProfile.number_tree }} ต้น</p>
      </div>
    </footer>
  </ng-container>

  <ng-template #loadingTemplate>
    <div class="loading-container">
      <p>กำลังโหลดสวนของคุณ...</p>
    </div>
  </ng-template>
</div>