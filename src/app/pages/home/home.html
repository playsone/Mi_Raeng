<div *ngIf="userProfile; else loadingTemplate" class="home-container d-flex flex-column vh-100 p-3 p-md-4">

    <header class="header">
        <div class="col-auto">
            <div class="info-box">
                <img src="assets/images/time.png" alt="Time Icon" class="icon">
                <span>{{ userProfile.minute }}</span>
            </div>
        </div>
        
        <div class="profile-info">
            <img [src]="profilePictureUrl" alt="Profile Picture" class="profile-pic" (click)="goTo('/profile')">
            <span class="profile-name">{{ userProfile.name }}</span>
        </div>

        <div class="col-auto">
            <div class="info-box">
                <img src="assets/images/star.png" alt="Star Icon" class="icon">
                <span>{{ userProfile.score }}</span>
            </div>
        </div>
    </header>

    <main class="main-content flex-grow-1 d-flex flex-column justify-content-center align-items-center">
        <img src="assets/images/treelogo.png" alt="Tree Logo" class="tree-logo mb-4" (click)="goTo('/mytree')">
        <div class="menu-grid">
            <button class="menu-item" (click)="goTo('/exercise')">
                <img src="assets/images/exer.png" alt="Exercise Icon">
                <span>‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</span>
            </button>
            <button class="menu-item" (click)="goTo('/ranking')">
                <img src="assets/images/graph.png" alt="Ranking Icon">
                <span>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</span>
            </button>
            <button class="menu-item" (click)="goTo('/mytree')">
                <img src="assets/images/tree.png" alt="My Tree Icon">
                <span>‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</span>
            </button>
            <button class="menu-item" (click)="goTo('/profile')">
                <img src="assets/images/proflie.png" alt="Profile Icon">
                <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</span>
            </button>
        </div>
    </main>

</div>

<ng-template #loadingTemplate>
    <div class="loading-container">
        <p>Loading profile...</p>
    </div>
</ng-template>



<!-- Welcome Popup Modal -->

<div *ngIf="showWelcomePopup" class="custom-modal-backdrop">
    <div class="custom-modal-content">
        
        <button class="close-icon-btn" (click)="closePopup()">
            &times; 
        </button>

        <div class="modal-header">
            <h2>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, {{ userProfile!.name }}! üëã</h2>
        </div>

        <div class="modal-body">
            <p style="font-weight: 500;">‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß!</p>
            
            <p>
                ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ <strong style="color: #4CAF50; font-size: 1.3em;">{{ treeCount }}</strong> ‡∏ï‡πâ‡∏ô
                <br>
                ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°: <strong style="color: #FF9800; font-size: 1.3em;">{{ userProfile!.score }}</strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            </p>
            
            <div *ngIf="remainingScore > 0">
                <p class="score-message">
                    üéØ ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏µ‡∏Å <strong style="color: #c62828;">{{ remainingScore }} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</strong> ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏≠‡∏µ‡∏Å 1 ‡∏ï‡πâ‡∏ô!
                </p>
            </div>
            <div *ngIf="remainingScore <= 0">
                <p class="score-message success">
                    üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß!
                </p>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-primary full-width-btn" (click)="goToExerciseFromPopup()">
                ‡πÑ‡∏õ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡∏±‡∏ô!
            </button>
        </div>
    </div>
</div>